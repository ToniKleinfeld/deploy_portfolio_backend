# Rate limiting
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
limit_req_zone $binary_remote_addr zone=web:10m rate=5r/s;

# Block common attacks
location ~* \.(env|git|sql|bak)$ {
    deny all;
    return 404;
}

location ~* /(wp-|admin|phpmyadmin) {
    deny all;
    return 404;
}

# Apply rate limiting
location / {
    limit_req zone=web burst=20 nodelay;
}

location /api/ {
    limit_req zone=api burst=50 nodelay;
}